<div class="container py-4">
  <h2 class="mb-3">Tasks</h2>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <!-- New Task Form -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row g-2">
        <div class="col-12 col-md-4">
          <input class="form-control"
                 placeholder="Title"
                 [(ngModel)]="model.title"
                 name="title">
        </div>
        <div class="col-12 col-md-5">
          <input class="form-control"
                 placeholder="Description"
                 [(ngModel)]="model.description"
                 name="description">
        </div>
        <div class="col-6 col-md-2">
          <select class="form-select" [(ngModel)]="model.priority" name="priority">
            <option *ngFor="let p of priorities" [ngValue]="p">{{ p }}</option>
          </select>
        </div>
        <div class="col-6 col-md-1">
          <select class="form-select" [(ngModel)]="model.status" name="status">
            <option *ngFor="let s of statuses" [ngValue]="s">{{ s }}</option>
          </select>
        </div>
      </div>

      <div class="mt-3 d-grid d-md-inline-block">
        <button class="btn btn-primary" (click)="addTask()">Add task</button>
      </div>
    </div>
  </div>

  <!-- Task List -->
  <div class="table-responsive">
    <table class="table align-middle">
      <thead>
      <tr>
        <th>Title</th>
        <th>Description</th>
        <th class="d-none d-md-table-cell">Priority</th>
        <th class="d-none d-md-table-cell">Status</th>
        <th class="text-end">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let t of tasks">
        <td class="fw-semibold">{{ t.title }}</td>
        <td class="text-muted">{{ t.description }}</td>
        <td class="d-none d-md-table-cell">{{ t.priority }}</td>
        <td class="d-none d-md-table-cell">
          <span class="badge text-bg-secondary">{{ t.status }}</span>
        </td>
        <td class="text-end">
          <button class="btn btn-sm btn-outline-success me-2" (click)="markDone(t)">Done</button>
          <button class="btn btn-sm btn-outline-danger" (click)="deleteTask(t)">Delete</button>
        </td>
      </tr>

      <tr *ngIf="!loading && tasks.length === 0">
        <td colspan="5" class="text-center text-muted">No tasks yet.</td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
